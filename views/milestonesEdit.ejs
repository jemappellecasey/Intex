<!-- views/milestones_edit.ejs -->
<!DOCTYPE html>
<html lang="en">
<head>
  <title>Edit Milestone</title>
  <%- include('partials/head') %>
</head>
<body>
<div class="layout">
  <%- include('partials/userbar') %>
  <%- include('partials/sidebar', { active: 'milestones' }) %>
  <main class="main">

<h1>Edit Milestone</h1>

  <% if (error_message) { %>
    <div class="alert alert-error"><%= error_message %></div>
  <% } %>
  <% if (success_message) { %>
    <div class="alert alert-success"><%= success_message %></div>
  <% } %>

<p>
  <a href="/milestones" class="btn secondary-btn">Back to Milestones List</a>
</p>

<% if (!milestone) { %>
  <p>Milestone not found.</p>
<% } else { %>
  <form method="post" action="/milestones/<%= milestone.milestoneid %>/edit" class="form-card form-shell">
    <input type="hidden" name="_csrf" value="<%= csrfToken %>">

    <table class="form-table compact">
      <tr>
        <th>Participant</th>
        <td>
          <%= milestone.participantfirstname %> <%= milestone.participantlastname %>
          (<%= milestone.email %>)
        </td>
      </tr>
      <tr>
        <th>Milestone Title*</th>
        <td>
          <input type="text"
                 name="milestonetitle"
                 value="<%= milestone.milestonetitle || '' %>"
                 required>
        </td>
      </tr>
      <tr>
        <th>Milestone Date*</th>
        <td>
          <input type="date"
                 name="milestonedate"
                 value="<%= milestone.milestonedate
                          ? new Date(milestone.milestonedate).toISOString().slice(0, 10)
                          : '' %>"
                 required>
        </td>
      </tr>
    </table>

    <div class="form-actions centered">
      <button type="submit" class="btn">Save Changes</button>
      <a href="/milestones" class="btn secondary-btn" style="margin-left:8px;">Cancel</a>
    </div>
  </form>
<% } %>

  </main>
</div>
</body>
</html>
