<!DOCTYPE html>
<html lang="en">
<head>
  <title>New Survey</title>
  <%- include('partials/head') %>
</head>
<body>
<div class="layout">
  <%- include('partials/userbar') %>
  <%- include('partials/sidebar', { active: 'surveys' }) %>
  <main class="main">

<h1>Create New Survey</h1>
<p>
  <a href="/surveys" class="btn secondary-btn">Back to Surveys List</a>
</p>

<% if (error_message) { %>
  <div class="alert alert-error"><%= error_message %></div>
<% } %>

<form method="post" action="/surveys/new" class="form-card form-shell">
  <!-- CSRF token -->
  <input type="hidden" name="_csrf" value="<%= csrfToken %>">

  <table>
    <tr>
      <th>Participant*</th>
      <td>
        <select name="participantid" required>
          <% participants.forEach(function(p) { %>
            <option value="<%= p.participantid %>">
              <%= p.participantfirstname %> <%= p.participantlastname %> (<%= p.email %>)
            </option>
          <% }) %>
        </select>
      </td>
    </tr>

    <tr>
      <th>Event*</th>
      <td>
        <select name="eventid" required>
          <% events.forEach(function(e) { %>
            <option value="<%= e.eventid %>">
              <%= e.eventname %>
            </option>
          <% }) %>
        </select>
      </td>
    </tr>

    <tr>
      <th>Event Date/Time Start*</th>
      <td>
        <input type="datetime-local" name="eventdatetimestart" required>
      </td>
    </tr>

    <tr>
      <th>Satisfaction (1–5)</th>
      <td><input type="number" name="surveysatisfactionscore" min="1" max="5"></td>
    </tr>
    <tr>
      <th>Usefulness (1–5)</th>
      <td><input type="number" name="surveyusefulnessscore" min="1" max="5"></td>
    </tr>
    <tr>
      <th>Instructor (1–5)</th>
      <td><input type="number" name="surveyinstructorscore" min="1" max="5"></td>
    </tr>
    <tr>
      <th>Recommendation (1–5)</th>
      <td><input type="number" name="surveyrecommendationscore" min="1" max="5"></td>
    </tr>

    <tr>
      <th>Overall</th>
      <td>N/A (auto-calculated)</td>
    </tr>

    <tr>
      <th>Submission Date</th>
      <td><input type="date" name="surveysubmissiondate"></td>
    </tr>
  </table>

  <div class="form-actions">
    <button type="submit">Create Survey</button>
  </div>
</form>

  </main>
</div>
</body>
</html>
